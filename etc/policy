grant CodeBase "file:jdcp-server.jar" {
	permission java.awt.AWTPermission "accessEventQueue";
	permission java.awt.AWTPermission "showWindowWithoutWarningBanner";
	permission java.awt.AWTPermission "toolkitModality";
	permission java.io.FilePermission "-", "read";
    permission java.io.FilePermission "server", "read,write,delete";
    permission java.io.FilePermission "server/-", "read,write,delete";
	permission java.lang.RuntimePermission "accessClassInPackage.sun.util.logging.resources";
	permission java.lang.RuntimePermission "createClassLoader";
	permission java.lang.RuntimePermission "exitVM.*";
	permission java.lang.RuntimePermission "preferences";
	permission java.lang.RuntimePermission "accessDeclaredMembers";
	permission java.lang.RuntimePermission "modifyThreadGroup";
	permission java.lang.RuntimePermission "loadLibrary.NTEventLogAppender";
	permission java.lang.RuntimePermission "shutdownHooks";
	permission java.net.SocketPermission "*:1024-", "accept,resolve,listen";
	permission java.util.PropertyPermission "os.name", "read";
	permission java.util.PropertyPermission "os.version", "read";
	permission java.util.PropertyPermission "user.dir", "read";
	permission java.util.PropertyPermission "log4j.*", "read";
	permission java.util.PropertyPermission "swing.*", "read";
	permission java.util.PropertyPermission "java.*", "read";
	permission javax.security.auth.AuthPermission "createLoginContext.JobService";
	permission javax.security.auth.AuthPermission "doAsPrivileged";
	permission javax.security.auth.AuthPermission "modifyPrincipals";
};

grant CodeBase "file:jdcp-common.jar" {
    permission java.awt.AWTPermission "accessEventQueue";
    permission java.awt.AWTPermission "showWindowWithoutWarningBanner";
    permission java.awt.AWTPermission "toolkitModality";
    permission java.io.FilePermission "-", "read";
    permission java.io.FilePermission "server", "read,write,delete";
    permission java.io.FilePermission "server/-", "read,write,delete";
    permission java.lang.RuntimePermission "accessClassInPackage.sun.util.logging.resources";
    permission java.lang.RuntimePermission "createClassLoader";
    permission java.lang.RuntimePermission "exitVM.*";
    permission java.lang.RuntimePermission "preferences";
    permission java.lang.RuntimePermission "accessDeclaredMembers";
    permission java.lang.RuntimePermission "modifyThreadGroup";
    permission java.lang.RuntimePermission "loadLibrary.NTEventLogAppender";
    permission java.lang.RuntimePermission "shutdownHooks";
    permission java.net.SocketPermission "*:1024-", "accept,resolve,listen";
    permission java.util.PropertyPermission "os.name", "read";
    permission java.util.PropertyPermission "os.version", "read";
    permission java.util.PropertyPermission "user.dir", "read";
    permission java.util.PropertyPermission "log4j.*", "read";
    permission java.util.PropertyPermission "swing.*", "read";
    permission java.util.PropertyPermission "java.*", "read";
    permission javax.security.auth.AuthPermission "createLoginContext.JobService";
    permission javax.security.auth.AuthPermission "doAsPrivileged";
    permission javax.security.auth.AuthPermission "modifyPrincipals";
};

grant CodeBase "file:lib/eandb.jar" {
    permission java.awt.AWTPermission "accessEventQueue";
    permission java.awt.AWTPermission "showWindowWithoutWarningBanner";
    permission java.awt.AWTPermission "toolkitModality";
    permission java.io.FilePermission "-", "read";
    permission java.io.FilePermission "server/-", "read,write,delete";
    permission java.lang.RuntimePermission "accessClassInPackage.sun.util.logging.resources";
    permission java.lang.RuntimePermission "createClassLoader";
    permission java.lang.RuntimePermission "exitVM.*";
    permission java.lang.RuntimePermission "preferences";
    permission java.lang.RuntimePermission "accessDeclaredMembers";
    permission java.lang.RuntimePermission "modifyThreadGroup";
    permission java.lang.RuntimePermission "loadLibrary.NTEventLogAppender";
    permission java.net.SocketPermission "*:1024-", "accept,resolve,listen";
    permission java.util.PropertyPermission "os.name", "read";
    permission java.util.PropertyPermission "os.version", "read";
    permission java.util.PropertyPermission "user.dir", "read";
    permission java.util.PropertyPermission "log4j.*", "read";
    permission java.util.PropertyPermission "swing.*", "read";
    permission javax.security.auth.AuthPermission "createLoginContext.JobService";
    permission javax.security.auth.AuthPermission "doAsPrivileged";
    permission javax.security.auth.AuthPermission "modifyPrincipals";
};

grant CodeBase "file:lib/derby.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:lib/derbyclient.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:lib/log4j-1.2.15.jar" {
	permission java.util.PropertyPermission "log4j.*", "read";
	permission java.io.FilePermission "etc/log4j.properties", "read";
	permission java.lang.RuntimePermission "loadLibrary.NTEventLogAppender";
	permission java.util.PropertyPermission "user.dir", "read";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.worker" {
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDefinition";
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDigest";
	permission ca.eandb.jdcp.security.JdcpPermission "getTaskWorker";
	permission ca.eandb.jdcp.security.JdcpPermission "requestTask";
	permission ca.eandb.jdcp.security.JdcpPermission "submitTaskResults";
	permission ca.eandb.jdcp.security.JdcpPermission "reportException";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.admin" {
    permission ca.eandb.jdcp.security.JdcpPermission "*";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.submitter.basic" {
	permission ca.eandb.jdcp.security.JdcpPermission "createJob";
	permission ca.eandb.jdcp.security.JdcpPermission "submitJob";
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDigest";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.submitter.advanced" {
	permission ca.eandb.jdcp.security.JdcpPermission "createJob";
	permission ca.eandb.jdcp.security.JdcpPermission "submitJob";
	permission ca.eandb.jdcp.security.JdcpPermission "setJobClassDefinition";
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDigest";
};
